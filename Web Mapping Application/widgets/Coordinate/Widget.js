//>>built
require({cache:{"widgets/Coordinate/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings","dojo/text!./config.json"],function(){})},"url:widgets/Coordinate/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"coordinateBackground"\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"coordinateMenuContainer" style\x3d"display:none"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"coordinateMenu"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"coordinateInfoMenu" class\x3d"coordinate-info-menu jimu-float-leading jimu-align-leading"\x3e\r\n      \x3cdiv class\x3d"jimu-float-leading coordinate-locate-container" data-dojo-attach-point\x3d"locateContainer"\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"locateButton" class\x3d"coordinate-locate jimu-float-leading"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"coordinateInfo" class\x3d"coordinate-info jimu-float-leading jimu-align-leading"\x3e\r\n\t\t\t\t${nls.loading}\r\n\t\t\t\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3cdiv class\x3d"jimu-float-trailing" data-dojo-attach-point\x3d"foldContainer"\x3e\r\n      \x3cdiv class\x3d"coordinate-foldable jimu-float-trailing" data-dojo-attach-point\x3d"foldableNode"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/Coordinate/css/style.css":".jimu-widget-coordinate .coordinate-background{padding: 2px 5px 2px 5px; line-height: 20px; overflow: hidden;}.jimu-widget-coordinate .coordinate-background:hover{background-color: rgba(255,255,255,0.6);}.jimu-widget-coordinate .coordinate-locate{width: 14px; height: 14px; background: url(images/locate.png) center no-repeat;}.jimu-widget-coordinate .coordinate-locate-container{width: 18px; height: 18px; padding: 2px;}.jimu-widget-coordinate .coordinate-locate-container:hover{background: url(images/locate-hover.png) center no-repeat; cursor: pointer;}.jimu-widget-coordinate .coordinate-locate-container-active{background: url(images/locate-active.png) center no-repeat !important;}.jimu-widget-coordinate .coordinate-info{margin: 0 5px;}.jimu-widget-coordinate .coordinate-foldable{background: url(images/unfold01.png) center no-repeat; width: 10px; height: 20px;}.jimu-widget-coordinate:hover .coordinate-foldable{background-image: url(images/unfold02.png);};",
"url:widgets/Coordinate/config.json":'{\r\n  "outputunit": "dms",\r\n  "spatialReferences": [],\r\n  "decimalPlaces": 3,\r\n  "addSeparator": true\r\n}',"*now":function(q){q(['dojo/i18n!*preload*widgets/Coordinate/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/html dojo/sniff dijit/_WidgetsInTemplateMixin esri/geometry/Point esri/SpatialReference jimu/BaseWidget jimu/utils dojo/_base/lang dojo/on dojo/dom-style dojo/dom-class dijit/DropDownMenu dijit/MenuItem dojo/aspect dojo/Deferred esri/request esri/tasks/ProjectParameters esri/geometry/webMercatorUtils jimu/portalUtils esri/config libs/usng/usng jimu/SpatialReference/unitUtils".split(" "),function(q,f,m,u,v,l,w,x,g,h,n,y,z,A,B,s,C,D,E,F,G,t,r){var H={INCHES:"Inches",
FOOT:"Foot",FEET:"Foot",YARDS:"Yards",MILES:"Miles",NAUTICAL_MILES:"Nautical_Miles",MILLIMETERS:"Millimeters",CENTIMETERS:"Centimeters",METER:"Meter",METERS:"Meter",KILOMETERS:"Kilometers",DECIMETERS:"Decimeters",DEGREE:"Decimal_Degrees",DECIMAL_DEGREES:"Decimal_Degrees",DEGREE_MINUTE_SECONDS:"Degree_Minutes_Seconds",MGRS:"MGRS",USNG:"USNG"},k={esriCentimeters:"CENTIMETERS",esriDecimalDegrees:"DECIMAL_DEGREES",esriDegreeMinuteSeconds:"DEGREE_MINUTE_SECONDS",esriDecimeters:"DECIMETERS",esriFeet:"FOOT",
esriInches:"INCHES",esriKilometers:"KILOMETERS",esriMeters:"METER",esriMiles:"MILES",esriMillimeters:"MILLIMETERS",esriNauticalMiles:"NAUTICAL_MILES",esriPoints:"POINTS",esriUnknownUnits:"UNKNOWN",esriYards:"YARDS"};return q([w,u],{baseClass:"jimu-widget-coordinate",name:"Coordinate",popMenu:null,selectedWkid:null,selectedItem:null,selectedTfWkid:null,forward:!0,enableRealtime:!1,geoServiceUrl:null,_mapWkid:null,_configured:!1,postMixInProperties:function(){this.nls.enableClick=this.nls.enableClick||
"Click to enable clicking map to get coordinates";this.nls.disableClick=this.nls.disableClick||"Click to disable clicking map to get coordinates"},startup:function(){this.inherited(arguments);this.selectedWkid=this._mapWkid=this.map.spatialReference.isWebMercator()?3857:this.map.spatialReference.wkid;!this.config.spatialReferences||!this.config.spatialReferences.length?f.setStyle(this.foldableNode,"display","none"):f.setStyle(this.foldableNode,"display","inline-block")},onOpen:function(){y.add(this.coordinateBackground,
"coordinate-background");this.own(h(this.map,"mouse-move",g.hitch(this,this.onMouseMove)));this.own(h(this.map,"click",g.hitch(this,this.onMapClick)));this.own(h(this.locateButton,"click",g.hitch(this,this.onLocateButtonClick)));m("ie")&&9>m("ie")?(this.own(h(this.coordinateBackground,"mouseover",g.hitch(this,this.onMouseOver))),this.own(h(this.coordinateBackground,"mouseout",g.hitch(this,this.onMouseOut)))):(this.own(h(this.foldContainer,"mouseover",g.hitch(this,this.onMouseOver))),this.own(h(this.foldContainer,
"mouseout",g.hitch(this,this.onMouseOut))));this.own(h(this.coordinateMenuContainer,"mouseover",g.hitch(this,this.onMouseOverMenu)));this.own(h(this.coordinateMenuContainer,"mouseout",g.hitch(this,this.onMouseOutMenu)));this._processData().then(g.hitch(this,function(a){this.initPopMenu(a)}),g.hitch(this,function(a){console.error(a)}))},_processMapUnits:function(a){var b=new s;if(a.units)b.resolve(a);else{var c=a.spatialReference,d=a.extent,e=c&&(c.latestWkid||c.wkid)||d&&d.spatialReference&&d.spatialReference.wkid,
f=this;require(["jimu/SpatialReference/srUtils"],function(c){c.loadResource().then(g.hitch(f,function(){var d=c.getCSUnit(e);a.units=d;b.resolve(a)}))})}return b},_processData:function(){var a=new s,b=this.map.itemInfo.itemData.baseMap.baseMapLayers[0];!this.config.spatialReferences||!this.config.spatialReferences.length?F.getUnits(this.appConfig.portalUrl).then(g.hitch(this,function(c){var d=b&&("BingMapsRoad"===b.type||"BingMapsHybrid"===b.type||"BingMapsAerial"===b.type),e=b&&"WebTiledLayer"===
b.type;b&&b.url?C({url:b.url,handleAs:"json",callbackParamName:"callback",content:{f:"json"}}).then(g.hitch(this,function(b){this._processMapUnits(b).then(g.hitch(this,function(b){var d=this._getUnconfiguredUnitOptions(b.units,c),e=b.spatialReference,g=b.extent,e={wkid:e&&(e.latestWkid||e.wkid)||g&&g.spatialReference&&g.spatialReference.wkid,label:"",outputUnit:d.outputUnit};e.options={sameSRWithMap:!0,defaultUnit:k[b.units]||b.units,isGeographicUnit:d.isGeographicUnit,isGeographicCS:d.isGeographicCS,
isProjectUnit:d.isProjectUnit,isProjectedCS:d.isProjectedCS,unitRate:d.unitRate};this._configured=!1;a.resolve(e)}))}),g.hitch(this,function(b){console.error(b);a.reject(b)})):b&&("OpenStreetMap"===b.type||d||e)?(d=this._getUnconfiguredUnitOptions("esriMeters",c),e={wkid:3857,label:"",outputUnit:d.outputUnit},e.options={sameSRWithMap:!0,defaultUnit:k.esriMeters,isGeographicUnit:d.isGeographicUnit,isGeographicCS:d.isGeographicCS,isProjectUnit:d.isProjectUnit,isProjectedCS:d.isProjectedCS,unitRate:d.unitRate},
this._configured=!1,a.resolve(e)):a.reject(Error("no baseMap"))})):(this._configured=!0,a.resolve(this.config.spatialReferences));return a},_getUnconfiguredUnitOptions:function(a,b){var c=k[a]||a,d="",e=1,g="",p="",f="",h="";r.isProjectUnit(c)?(f=h=!0,g=p=!1,d="english"===b?k.esriFeet.toUpperCase():k.esriMeters.toUpperCase(),e=r.getUnitRate(c.toUpperCase(),d)):r.isGeographicUnit(c)&&(f=h=!1,g=p=!0,d=c.toUpperCase());this.map.spatialReference.isWebMercator()&&(d=k.esriDecimalDegrees,p=!0,h=!1,e=1);
return{outputUnit:d,unitRate:e,isGeographicUnit:p,isGeographicCS:g,isProjectUnit:h,isProjectedCS:f}},initPopMenu:function(a){this.popMenu=new z({},this.coordinateMenu);B.after(this.popMenu,"onItemClick",g.hitch(this,this.onClickMenu),!0);"[object Array]"!==Object.prototype.toString.call(a)?(this.selectedWkid=parseInt(a.wkid,10),this.addMenuItem("",this.selectedWkid,a.outputUnit,null,null,a.options)):(this.selectedWkid=parseInt(a[0].wkid,10),this.selectedTfWkid=a[0].transformationWkid&&parseInt(a[0].transformationWkid,
10),this._addAllMenuItems());this.selectedItem=this.popMenu.getChildren()[0];this._adjustCoordinateInfoUI(this.selectedWkid);this.popMenu.startup()},_addAllMenuItems:function(){for(var a=this.config.spatialReferences.length,b=0;b<a;b++)this.addMenuItem(this.config.spatialReferences[b].label,this.config.spatialReferences[b].wkid,this.config.spatialReferences[b].outputUnit,this.config.spatialReferences[b].transformationWkid,this.config.spatialReferences[b].transformForward,this.config.spatialReferences[b].options)},
_isWebMercator:function(a){return l.prototype._isWebMercator?l.prototype._isWebMercator.apply({wkid:parseInt(a,10)},[]):(new l(parseInt(a,10))).isWebMercator()},canShowInClient:function(a){a=4326===this._mapWkid&&this._isWebMercator(a)||this._isWebMercator(this._mapWkid)&&4326===parseInt(a,10);var b=this.selectedItem.get("options");return b&&b.sameSRWithMap||a?!0:!1},onClickMenu:function(a){this.selectedItem.set({label:this.getStatusString(!1,this.selectedItem.params.name,this.selectedItem.params.wkid)});
this.selectedWkid=parseInt(a.params.wkid,10);this.selectedTfWkid=a.params.tfWkid;this.forward=a.params.forward;a.set({label:this.getStatusString(!0,a.params.name,a.params.wkid)});this.selectedItem=a;this._adjustCoordinateInfoUI(this.selectedWkid)},_adjustCoordinateInfoUI:function(a){this.canShowInClient(a)?(this.enableRealtime=!0,this.coordinateInfo.innerHTML=this.nls.realtimeLabel,f.setStyle(this.locateContainer,"display","block"),f.removeClass(this.locateContainer,"coordinate-locate-container-active"),
f.setAttr(this.locateButton,"title",this.nls.enableClick),this.enableWebMapPopup()):(this.enableRealtime=!1,this.coordinateInfo.innerHTML=this.nls.hintMessage,f.setStyle(this.locateContainer,"display","none"),f.setAttr(this.locateButton,"title",this.nls.disableClick),this.disableWebMapPopup());(m("ios")||m("android"))&&f.setStyle(this.locateContainer,"display","none")},disableWebMapPopup:function(){this.map.setInfoWindowOnClick(!1)},enableWebMapPopup:function(){this.map.setInfoWindowOnClick(!0)},
onLocateButtonClick:function(){f.toggleClass(this.locateContainer,"coordinate-locate-container-active");this.enableRealtime?(this.enableRealtime=!1,this.coordinateInfo.innerHTML=this.nls.hintMessage,f.setAttr(this.locateButton,"title",this.nls.disableClick),this.disableWebMapPopup()):(this.enableRealtime=!0,this.coordinateInfo.innerHTML=this.nls.realtimeLabel,f.setAttr(this.locateButton,"title",this.nls.enableClick),this.enableWebMapPopup())},getStatusString:function(a,b,c){var d="",e=this._mapWkid;
c=parseInt(c,10);d=a?"\x26nbsp;\x26nbsp;\x26bull;\x26nbsp;\x26nbsp;\x3cb\x3e"+d+b+"\x3c/b\x3e\x26nbsp;("+c+")\x26lrm;\x26nbsp;":"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;"+d+b+"\x26nbsp;\x26nbsp;("+c+")\x26lrm;\x26nbsp;";c===e&&(d+=this.nls.defaultLabel);return d},addMenuItem:function(a,b,c,d,e,g){var f=this.getStatusString(!1,a,b);this.selectedWkid===parseInt(b,10)&&(f=this.getStatusString(!0,a,b));a={label:f||"",name:a||"",wkid:b||"",outputUnit:c||"",tfWkid:d||"",options:g};a.tfWkid&&
(a.forward=e);this.popMenu.addChild(new A(a))},_toFormat:function(a){var b=isFinite(parseInt(this.config.decimalPlaces,10))?parseInt(this.config.decimalPlaces,10):3,c=(a.toString().split(".")[1]||"").length,d="",e=c<b?c:b;c<b&&(d=Array.prototype.join.call({length:b-c+1},"0"));a=a.toFixed(e)+d;return this.separator(a,b)},onProjectComplete:function(a,b){if(this.selectedWkid&&a===this.selectedWkid){var c=b[0],d=c.x,c=c.y,e=this.selectedItem.get("outputUnit"),g=this.selectedItem.get("options");"MGRS"===
e||"USNG"===e?this._displayUsngOrMgrs(e,c,d):g.isGeographicUnit?this._displayDegOrDms(e,c,d):this._displayProject(e,c,d)}},_unitToNls:function(a){var b=H[a.toUpperCase()];return this.nls[b]||this.nls[a]||a},onError:function(a){alert(a)},onMapClick:function(a){if(!this.enableRealtime&&this.selectedItem)if(this.canShowInClient(this.selectedWkid))this._displayOnClient(a.mapPoint);else{a=new v(a.mapPoint.x,a.mapPoint.y,this.map.spatialReference);var b=new D,c=null,d=this.selectedItem.get("options");b.geometries=
[a];d.isProjectedCS?c=d.isProjectUnit?this.selectedWkid:d.spheroidCS:d.isGeographicCS&&(c=this.selectedWkid);this.selectedTfWkid&&(b.transformation=new l(parseInt(this.selectedTfWkid,10)),b.transformForward=JSON.parse(this.forward));b.outSR=new l(parseInt(c,10));this.coordinateInfo.innerHTML=this.nls.computing;G.defaults.geometryService.project(b,g.hitch(this,this.onProjectComplete,this.selectedWkid),g.hitch(this,this.onError))}},_displayOnClient:function(a){var b=this.selectedItem.get("outputUnit"),
c=a.x,d=a.y,e=null,g=4326===this._mapWkid&&this._isWebMercator(this.selectedWkid)||this._isWebMercator(this._mapWkid)&&4326===this.selectedWkid,f=this.selectedItem.get("options"),e=a.normalize();f.isGeographicUnit&&(c=e.getLongitude()||c);f.isGeographicUnit&&(d=e.getLatitude()||d);g?4326===a.spatialReference.wkid&&this._isWebMercator(this.selectedWkid)?"MGRS"===b||"USNG"===b?this._displayUsngOrMgrs(b,e.getLatitude(),e.getLongitude()):f.isGeographicUnit?this._displayDegOrDms(b,d,c):f.isProjectUnit&&
(a=E.lngLatToXY(c,d),this._displayProject(b,a[1],a[0])):a.spatialReference.isWebMercator()&&4326===this.selectedWkid&&("MGRS"===b||"USNG"===b?this._displayUsngOrMgrs(b,e.getLatitude(),e.getLongitude()):f.isGeographicUnit&&this._displayDegOrDms(b,d,c)):f.defaultUnit===b?(this.coordinateInfo.innerHTML=this._toFormat(c)+"\x26nbsp;\x26nbsp;"+this._toFormat(d),this.coordinateInfo.innerHTML+=" "+this._unitToNls(b)):4326===a.spatialReference.wkid||a.spatialReference.isWebMercator()?"MGRS"===b||"USNG"===
b?this._displayUsngOrMgrs(b,e.getLatitude(),e.getLongitude()):f.isGeographicUnit?this._displayDegOrDms(b,d,c):f.isProjectedCS&&this._displayProject(b,d,c):f.isProjectedCS?this._displayProject(b,d,c):f.isGeographicCS&&("MGRS"===b||"USNG"===b?this._displayUsngOrMgrs(b,d,c):f.isGeographicUnit&&this._displayDegOrDms(b,d,c))},onMouseMove:function(a){this.enableRealtime&&this.selectedItem&&this._displayOnClient(a.mapPoint)},_displayUsngOrMgrs:function(a,b,c){"MGRS"===a?this.coordinateInfo.innerHTML=t.LLtoMGRS(b,
c,5):"USNG"===a&&(this.coordinateInfo.innerHTML=t.LLtoUSNG(b,c,5));this.coordinateInfo.innerHTML+=" "+this._unitToNls(a)},_displayDegOrDms:function(a,b,c){var d="",e="",d=this.selectedItem.get("options");c*=d.unitRate;b*=d.unitRate;"DEGREE_MINUTE_SECONDS"===a?(d=this.degToDMS(b,"LAT"),e=this.degToDMS(c,"LON"),this.coordinateInfo.innerHTML=d+"\x26nbsp;\x26nbsp;\x26nbsp;"+e):(this.coordinateInfo.innerHTML=this._toFormat(b)+"\x26nbsp;\x26nbsp;"+this._toFormat(c),this.coordinateInfo.innerHTML+=" "+this._unitToNls(a))},
_displayProject:function(a,b,c){var d=this.selectedItem.get("options");c*=d.unitRate;b*=d.unitRate;this.coordinateInfo.innerHTML=this._toFormat(c)+"\x26nbsp;\x26nbsp;"+this._toFormat(b);this.coordinateInfo.innerHTML+=" "+this._unitToNls(a)},onMouseOver:function(){if(this._configured){n.set(this.coordinateMenuContainer,"display","block");var a=f.getMarginBox(this.coordinateInfoMenu),b=f.getContentBox(this.coordinateBackground);0<b.w-a.w&&f.setStyle(this.foldContainer,"width",b.w-a.w+"px")}},onMouseOut:function(){n.set(this.coordinateMenuContainer,
"display","none");f.setStyle(this.foldContainer,"width","10px")},onMouseOverMenu:function(){n.set(this.coordinateMenuContainer,"display","block")},onMouseOutMenu:function(){n.set(this.coordinateMenuContainer,"display","none");f.setStyle(this.foldContainer,"width","10px")},degToDMS:function(a,b){var c=Math.abs(a),d=Math.floor(c),c=c-d,e=Math.floor(60*c),c=Math.floor(3600*(c-e/60));60===c&&(e++,c=0);60===e&&(d++,e=0);return d+"\x26deg;"+(10>e?"0"+e:e)+"\x26prime;"+(10>c?"0"+c:c)+"\x26Prime;"+("LAT"===
b?0>a?"S":"N":0>a?"W":"E")},separator:function(a,b){return this.config.addSeparator&&JSON.parse(this.config.addSeparator)?x.localizeNumber(a,{places:b}):a}})});